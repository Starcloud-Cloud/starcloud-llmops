<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.starcloud.ops.business.app.dal.mysql.xhs.batch.CreativePlanBatchMapper">
    <select id="latestBatch" resultType="com.starcloud.ops.business.app.dal.databoject.xhs.batch.CreativePlanBatchDO">
        SELECT *
        FROM llm_creative_plan_batch p
        INNER JOIN
        (SELECT MAX(batch) as batch, plan_uid from llm_creative_plan_batch where
        plan_uid in
        <foreach collection="planUidList" item="uid" open="(" separator="," close=")">
            #{uid}
        </foreach>
        and deleted = false
        GROUP BY plan_uid) s
        ON p.plan_uid = s.plan_uid and p.batch = s.batch
    </select>
</mapper>